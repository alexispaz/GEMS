#  gms file
#  
#    ___________________   _____    _________
#   /  _____/\_   _____/  /     \  /   _____/
#  /   \  ___ |    __)_  /  \ /  \ \_____  \
#  \    \_\  \|        \/    Y    \/        \
#   \______  /_______  /\____|__  /_______  /
#          \/        \/         \/         \/
#        is an Extensible Molecular Simulator
#  
#  Copyright (C) 2020 Sergio Alexis Paz
#  This program comes with ABSOLUTELY NO WARRANTY; for details type `warranty`.
#  This is free software, and you are welcome to redistribute it
#  under certain conditions; type `license` for details.
#  
#  Version:0149-dirty
#  I/O Units:
#    -input: bloques.gms
#    -log:   bloques.log
#    -chp:   bloques.chp
#  MPI: Not compiled for MPI
#  OpenMP: Using 8 threads
#-WAN-> F2003 standar do not specify PRNG implementation, so this is a compiler dependent choice.
#  Random Seed: 
#    -1112042056
#    530525088
#    364513989
#    -1653425248
#    -1426479949
#    -742062200
#    -19037222
#    1963206470
# Input script for GEMS

# Testing blocks
bloque repeat 12
  print {2*$i$}
fin
#-STD->  >>> iterando: $i$=0
# 2.0000000000000000
#-STD->  >>> iterando: $i$=0
# 4.0000000000000000
#-STD->  >>> iterando: $i$=0
# 6.0000000000000000
#-STD->  >>> iterando: $i$=0
# 8.0000000000000000
#-STD->  >>> iterando: $i$=0
# 10.000000000000000
#-STD->  >>> iterando: $i$=0
# 12.000000000000000
#-STD->  >>> iterando: $i$=0
# 14.000000000000000
#-STD->  >>> iterando: $i$=0
# 16.000000000000000
#-STD->  >>> iterando: $i$=0
# 18.000000000000000
#-STD->  >>> iterando: $i$=10
# 20.000000000000000
#-STD->  >>> iterando: $i$=11
# 22.000000000000000
#-STD->  >>> iterando: $i$=12
# 24.000000000000000

bloque save 1
   print hola
fin

bloque save 2
   print dm_steps
fin

bloque load 1
# hola

# Box
box size 5.78 5.78 5.78

# Play with particles that will not be used
+ atom 2.2 1 10
#-STD->            1 particles in system
> all
#-STD->            1 particles selected
^+ reply 0 0 1 10
#-STD->           10 particles in system
#-STD->           10 particles selected
^- zrange 15 20
#-STD->            4 particles deleted
^~ zrange 13 20
#-STD->            4 particles selected
group 2 add
#-STD->            4 particles in group           2

# Particles that will be used
>+ atom 1 1 1
#-STD->            7 particles in system
#-STD->            1 particles selected
^+ atom 2.2 1 1
#-STD->            8 particles in system
#-STD->            2 particles selected
set element H

> element H
#-STD->            2 particles selected
set pbc F F F
set mass 3.
group 1 add
#-STD->            2 particles in group           1

# Save variables for later use
^> atom 1
#-STD->            1 particles selected
getin x1 cm_pos
#-STD-> x1[1] = 1.000000
#-STD-> x1[2] = 1.000000
#-STD-> x1[3] = 1.000000
> group 1
#-STD->            2 particles selected
^> atom 2
#-STD->            1 particles selected
getin x2 cm_pos
#-STD-> x2[1] = 2.200000
#-STD-> x2[2] = 1.000000
#-STD-> x2[3] = 1.000000

# Testing interaction commands
interact 1 pair lj 1. 0.890898718140339 2
#-STD-> The interaction label is :i1
# NHB Not using linked cells since it would involve less than 4 cells.
# NHB  -cut radious:    2.00000

# Testing math
tau_ps:=0.01018
time step {0.002*$tau_ps$}   (integration timestep [ps])

# Testing evolve commands
> all
#-STD->            8 particles selected
evolve ermak 100 1
#-STD-> The algorithm label is :1
# REF This feature use the following references:
# REF - D. L. Ermak and H. Buckholz, “Numerical integration of the Langevin equation:
# REF   Monte Carlo simulation”, J. Comput. Phys. 35, 169 (1980)
# REF - M. P. Allen and D. J. Tildesley, "Computer simulation of liquids" Chap 9, "Brownian Dinamics", Pag 263
# REF - I. Snook, "The ermak and Generalised Langevin Apprroach to the Dynamics of
# REF   Atomic, Polymeric and Colloidal System". Elsevier, Sec 6.2.4 "A
# REF   third first-order BD algorithm", Pag 118.
evolve :1 v_verlet
bloque load_each 3 2
dinamica 6
#-STD-> 1 steps reached!
#-STD-> 1neigh searches
#-STD-> average wall time per step:      0.000 s
#-STD->       0.00ps simulated!
#-STD-> average wall time per ns:      0.000 s
# 3.000000
# 6.000000

# Print properties
> atom 7
#-STD->            1 particles selected
print cm_pos
# 1.000053
# 1.000000
# 1.000000
> atom 8
#-STD->            1 particles selected
print cm_pos
# 2.199947
# 1.000000
# 1.000000

# Testing set/get
> group 1
#-STD->            2 particles selected
^> atom 1
#-STD->            1 particles selected
set cm_pos $x1[1] $x1[2] $x1[3]
print cm_pos
# 1.000000
# 1.000000
# 1.000000

# Final deletion of particles
- group 2
#-STD->            2 particles deleted

#-STD-> cpu time:      0.011 s
#-STD-> wall time:      0.000 s
#-STD-> vecinos actualizados: 1 veces
